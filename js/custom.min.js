function animateStep(e, t) {
    var i = $("[data-step=" + e + "]");
    $new_step = $("[data-step=" + t + "]"), did_show_results && resetResults(), window.scrollTo(0, 0), e != t && e <= numSteps ? (i.removeClass("is--active"), i.find(".step__wrapper").height(0), $new_step.addClass("is--active is--visible"), checkOrientation(isMobile)) : (queryErrors = !0, $("[data-step]").removeClass("is--active is--visible").find(".step__wrapper").height(0), $new_step.addClass("is--active is--visible"), checkOrientation(isMobile), activeStep = $new_step, video.pause(), video.currentTime = 18)
    console.log(e)
    if(e===5){
        $('#footer').html("<ul>\n" +
            "            <li>\n" +
            "                <p ng-hide=\"!abc\">\n" +
            "                    Â© 2020. IBRO <br></p>\n" +
            "            </li>\n" +
            "        </ul>")
    }
}

function videoLogic() {
    $("[data-play]").on("click", function () {
        var e = $(this);
        setTimeout(function () {
            var t = parseFloat(e.data("play"));
            video.currentTime = t, video.play(), activeStep.is('[data-step="1"]') ? $('[data-step="1"]').addClass("is--loading") : (video.classList.remove("is--blurry"), activeStep.removeClass("is--visible"), timer.addClass("is--active animation animation" + parseInt(activeStep.data("step"))))
        }, 100)
    }), $("[data-validate]").on("click", function () {
        var e = $(this), t = $("#email").val();
        if (validateEmail(t) && t != lastValue) {
            var i;
            queryErrors ? (i = parseFloat($("[data-last]").find("[data-play]").data("play")), angular.element("[ng-controller]").scope().mst.curr_step = parseInt($("[data-last]").data("step")), angular.element("[ng-controller]").scope().nextStep()) : i = parseFloat(e.data("validate")), video.currentTime = i, video.play(), video.classList.remove("is--blurry"), activeStep.removeClass("is--visible"), lastValue = t, timer.addClass("is--active animation animation" + parseInt(activeStep.data("step")))
        } else {
            var r = e.parents(".form__group"), n = r.find('[data-error="email"]');
            r.addClass("form__group--error"), n.html("Invalid Email Address")
        }
    }), $("#email").on("keypress", function (e) {
        if (13 == e.keyCode) {
            var t = $(this), i = t.val();
            if (validateEmail(i) && i != lastValue) {
                var r;
                queryErrors ? (r = parseFloat($("[data-last]").find("[data-play]").data("play")), angular.element("[ng-controller]").scope().mst.curr_step = parseInt($("[data-last]").data("step")), angular.element("[ng-controller]").scope().nextStep()) : r = parseFloat(t.parents(".step").find("[data-validate]").data("validate")), video.currentTime = r, video.play(), video.classList.remove("is--blurry"), activeStep.removeClass("is--visible"), lastValue = i, timer.addClass("is--active animation animation" + parseInt(activeStep.data("step")))
            } else {
                var n = t.parents(".form__group"), a = n.find('[data-error="email"]');
                n.addClass("form__group--error"), a.html("Invalid Email Address")
            }
        }
    }), $("#email").on("input propertychange", function () {
        var e = $(this), t = e.val();
        (validateEmail(t) || "" == t) && e.parents(".form__group").removeClass("form__group--error")
    }), $("#email").on("focus", function () {
        isMobile && $("html").addClass("is--inputfocus")
    }).on("blur", function () {
        isMobile && setTimeout(function () {
            $("html").removeClass("is--inputfocus")
        }, 300)
    }), video.addEventListener("timeupdate", function () {
        var e = parseInt(video.currentTime);
        video.currentTime > .1 && !poster.hasClass("is--hidden") && (poster.addClass("is--hidden"), video.classList.remove("is--blurry"), activeStep.removeClass("is--visible"), timer.addClass("is--active animation animation" + parseInt(activeStep.data("step")))), videoStopped != e && (videoStopped = !1), videoStopped || e === parseInt(activeStep.find("[data-stop]").data("stop")) && (video.pause(), videoStopped = e)
    }), video.addEventListener("pause", function () {
        timer.removeClass("is--active animation animation" + parseInt(activeStep.data("step"))), queryErrors || showUpgrade || (angular.element("[ng-controller]").scope().nextStep(), activeStep = $(".step.is--active")), showUpgrade && ($("[data-step]").removeClass("is--active is--visible").find(".step__wrapper").height(0), angular.element("[ng-controller]").scope().handleUpgradePage(), checkOrientation(isMobile)), video.classList.add("is--blurry")
    })
}

function setVideoFallback(e) {
    if (isMobile = e.is_mobile, checkOrientation(isMobile), isMobile) {
        $("html").addClass("is--mobile");
        var t = e.device_name, i = parseInt(e.version), r = (e.browser, e.platform);
        "iPhone" != t && "iPad" != t || ($("html").addClass("is--ios"), i < 10 && enableInlineVideo(video)), "Android" == r && $("html").addClass("is--android")
    } else $("html").addClass("is--desktop")
}

function handleErrors(e) {
    $("[data-error]").html(""), $(".form__group").removeClass("form__group--error"), angular.forEach(e, function (e) {
        switch (e.field) {
            case"email":
                $('[data-error="' + e.field + '"]').html(e.error), $('[ng-model="' + e.field + '"]').parents(".form__group").addClass("form__group--error")
        }
    }), $('button, input[type="submit"]').removeAttr("disabled")
}

function handleSuccess(e) {
    var t = $("input[ng-model=email]").val(), i = !1;
    t.indexOf("@teamcmp.com") > -1 && (i = !0), $.post("/common/dg_counter.php", {
        dg_tracker: "wh.registration.tour.redirection",
        email: t,
        test_user: i,
        need_user_interaction: !1
    }), showUpgrade = !0, window.scrollTo(0, 0)
}

function animateUpgrade(e) {
    $("[data-djs]").attr("href", e.wh_login + e.djs_redirect.trial), $("[data-home]").attr("href", e.wh_login + e.home_redirect), $("[data-step]").removeClass("is--active is--visible"), $("[data-upgrade]").addClass("is--active is--visible")
}

function validateEmail(e) {
    return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)
}

function checkOrientation(e) {
    var t = !($(window).width() > $(window).height()), i = $(".is--active .step__wrapper");
    (e && t || !e) && i.height($(window).height())
}

!function (e, t, i) {
    function r(e, t) {
        return typeof e === t
    }

    function n(e) {
        return e.replace(/([a-z])-([a-z])/g, function (e, t, i) {
            return t + i.toUpperCase()
        }).replace(/^-/, "")
    }

    function a(e, t) {
        return !!~("" + e).indexOf(t)
    }

    function s() {
        return "function" != typeof t.createElement ? t.createElement(arguments[0]) : w ? t.createElementNS.call(t, "http://www.w3.org/2000/svg", arguments[0]) : t.createElement.apply(t, arguments)
    }

    function o(e, t) {
        return function () {
            return e.apply(t, arguments)
        }
    }

    function d(e, t, i) {
        var n;
        for (var a in e) if (e[a] in t) return !1 === i ? e[a] : (n = t[e[a]], r(n, "function") ? o(n, i || t) : n);
        return !1
    }

    function l(e) {
        return e.replace(/([A-Z])/g, function (e, t) {
            return "-" + t.toLowerCase()
        }).replace(/^ms-/, "-ms-")
    }

    function u(t, i, r) {
        var n;
        if ("getComputedStyle" in e) {
            n = getComputedStyle.call(e, t, i);
            var a = e.console;
            null !== n ? r && (n = n.getPropertyValue(r)) : a && a[a.error ? "error" : "log"].call(a, "getComputedStyle returning null, its possible modernizr test results are inaccurate")
        } else n = !i && t.currentStyle && t.currentStyle[r];
        return n
    }

    function p() {
        var e = t.body;
        return e || (e = s(w ? "svg" : "body"), e.fake = !0), e
    }

    function c(e, i, r, n) {
        var a, o, d, l, u = "modernizr", c = s("div"), v = p();
        if (parseInt(r, 10)) for (; r--;) d = s("div"), d.id = n ? n[r] : u + (r + 1), c.appendChild(d);
        return a = s("style"), a.type = "text/css", a.id = "s" + u, (v.fake ? v : c).appendChild(a), v.appendChild(c), a.styleSheet ? a.styleSheet.cssText = e : a.appendChild(t.createTextNode(e)), c.id = u, v.fake && (v.style.background = "", v.style.overflow = "hidden", l = _.style.overflow, _.style.overflow = "hidden", _.appendChild(v)), o = i(c, e), v.fake ? (v.parentNode.removeChild(v), _.style.overflow = l, _.offsetHeight) : c.parentNode.removeChild(c), !!o
    }

    function v(t, r) {
        var n = t.length;
        if ("CSS" in e && "supports" in e.CSS) {
            for (; n--;) if (e.CSS.supports(l(t[n]), r)) return !0;
            return !1
        }
        if ("CSSSupportsRule" in e) {
            for (var a = []; n--;) a.push("(" + l(t[n]) + ":" + r + ")");
            return a = a.join(" or "), c("@supports (" + a + ") { #modernizr { position: absolute; } }", function (e) {
                return "absolute" == u(e, null, "position")
            })
        }
        return i
    }

    function f(e, t, o, d) {
        function l() {
            p && (delete T.style, delete T.modElem)
        }

        if (d = !r(d, "undefined") && d, !r(o, "undefined")) {
            var u = v(e, o);
            if (!r(u, "undefined")) return u
        }
        for (var p, c, f, m, h, g = ["modernizr", "tspan", "samp"]; !T.style && g.length;) p = !0, T.modElem = s(g.shift()), T.style = T.modElem.style;
        for (f = e.length, c = 0; f > c; c++) if (m = e[c], h = T.style[m], a(m, "-") && (m = n(m)), T.style[m] !== i) {
            if (d || r(o, "undefined")) return l(), "pfx" != t || m;
            try {
                T.style[m] = o
            } catch (e) {
            }
            if (T.style[m] != h) return l(), "pfx" != t || m
        }
        return l(), !1
    }

    function m(e, t, i, n, a) {
        var s = e.charAt(0).toUpperCase() + e.slice(1), o = (e + " " + $.join(s + " ") + s).split(" ");
        return r(t, "string") || r(t, "undefined") ? f(o, t, n, a) : (o = (e + " " + E.join(s + " ") + s).split(" "), d(o, t, i))
    }

    var h = [], g = [], y = {
        _version: "3.5.0",
        _config: {classPrefix: "", enableClasses: !0, enableJSClass: !0, usePrefixes: !0},
        _q: [],
        on: function (e, t) {
            var i = this;
            setTimeout(function () {
                t(i[e])
            }, 0)
        },
        addTest: function (e, t, i) {
            g.push({name: e, fn: t, options: i})
        },
        addAsyncTest: function (e) {
            g.push({name: null, fn: e})
        }
    }, b = function () {
    };
    b.prototype = y, b = new b;
    var _ = t.documentElement, w = "svg" === _.nodeName.toLowerCase(), C = "Moz O ms Webkit",
        $ = y._config.usePrefixes ? C.split(" ") : [];
    y._cssomPrefixes = $;
    var S = function (t) {
        var r, n = prefixes.length, a = e.CSSRule;
        if (void 0 === a) return i;
        if (!t) return !1;
        if (t = t.replace(/^@/, ""), (r = t.replace(/-/g, "_").toUpperCase() + "_RULE") in a) return "@" + t;
        for (var s = 0; n > s; s++) {
            var o = prefixes[s];
            if (o.toUpperCase() + "_" + r in a) return "@-" + o.toLowerCase() + "-" + t
        }
        return !1
    };
    y.atRule = S;
    var E = y._config.usePrefixes ? C.toLowerCase().split(" ") : [];
    y._domPrefixes = E;
    var k = {elem: s("modernizr")};
    b._q.push(function () {
        delete k.elem
    });
    var T = {style: k.elem.style};
    b._q.unshift(function () {
        delete T.style
    }), y.testAllProps = m;
    var x = y.prefixed = function (e, t, i) {
        return 0 === e.indexOf("@") ? S(e) : (-1 != e.indexOf("-") && (e = n(e)), t ? m(e, t, i) : m(e, "pfx"))
    };
    b.addTest("objectfit", !!x("objectFit"), {aliases: ["object-fit"]}), function () {
        var e, t, i, n, a, s, o;
        for (var d in g) if (g.hasOwnProperty(d)) {
            if (e = [], (t = g[d]).name && (e.push(t.name.toLowerCase()), t.options && t.options.aliases && t.options.aliases.length)) for (i = 0; i < t.options.aliases.length; i++) e.push(t.options.aliases[i].toLowerCase());
            for (n = r(t.fn, "function") ? t.fn() : t.fn, a = 0; a < e.length; a++) s = e[a], 1 === (o = s.split(".")).length ? b[o[0]] = n : (!b[o[0]] || b[o[0]] instanceof Boolean || (b[o[0]] = new Boolean(b[o[0]])), b[o[0]][o[1]] = n), h.push((n ? "" : "no-") + o.join("-"))
        }
    }(), function (e) {
        var t = _.className, i = b._config.classPrefix || "";
        if (w && (t = t.baseVal), b._config.enableJSClass) {
            var r = new RegExp("(^|\\s)" + i + "no-js(\\s|$)");
            t = t.replace(r, "$1" + i + "js$2")
        }
        b._config.enableClasses && (t += " " + i + e.join(" " + i), w ? _.className.baseVal = t : _.className = t)
    }(h), delete y.addTest, delete y.addAsyncTest;
    for (var A = 0; A < b._q.length; A++) b._q[A]();
    e.Modernizr = b
}(window, document);
var enableInlineVideo = function () {
        "use strict";

        function e(e, t, i, r) {
            function n(i) {
                a = t(n, r), e(i - (s || i)), s = i
            }

            var a, s;
            return {
                start: function () {
                    a || n(0)
                }, stop: function () {
                    i(a), a = null, s = 0
                }
            }
        }

        function t(t) {
            return e(t, requestAnimationFrame, cancelAnimationFrame)
        }

        function i(e, t, i, r) {
            function n(t) {
                Boolean(e[i]) === Boolean(r) && t.stopImmediatePropagation(), delete e[i]
            }

            return e.addEventListener(t, n, !1), n
        }

        function r(e, t, i, r) {
            function n(e) {
                i[t] = e
            }

            r && n(e[t]), Object.defineProperty(e, t, {
                get: function () {
                    return i[t]
                }, set: n
            })
        }

        function n(e, t, i) {
            i.addEventListener(t, function () {
                return e.dispatchEvent(new Event(t))
            })
        }

        function a(e, t) {
            Promise.resolve().then(function () {
                e.dispatchEvent(new Event(t))
            })
        }

        function s(e) {
            var t = new Audio;
            return n(e, "play", t), n(e, "playing", t), n(e, "pause", t), t.crossOrigin = e.crossOrigin, t.src = e.src || e.currentSrc || "data:", t
        }

        function o(e, t, i) {
            (f || 0) + 200 < Date.now() && (e[g] = !0, f = Date.now()), i || (e.currentTime = t), _[++w % 3] = 100 * t | 0
        }

        function d(e) {
            return e.driver.currentTime >= e.video.duration
        }

        function l(e) {
            var t = this;
            t.video.readyState >= t.video.HAVE_FUTURE_DATA ? (t.hasAudio || (t.driver.currentTime = t.video.currentTime + e * t.video.playbackRate / 1e3, t.video.loop && d(t) && (t.driver.currentTime = 0)), o(t.video, t.driver.currentTime)) : t.video.networkState === t.video.NETWORK_IDLE && 0 === t.video.buffered.length && t.video.load(), t.video.ended && (delete t.video[g], t.video.pause(!0))
        }

        function u() {
            var e = this, t = e[h];
            return e.webkitDisplayingFullscreen ? void e[y]() : ("data:" !== t.driver.src && t.driver.src !== e.src && (o(e, 0, !0), t.driver.src = e.src), void (e.paused && (t.paused = !1, 0 === e.buffered.length && e.load(), t.driver.play(), t.updater.start(), t.hasAudio || (a(e, "play"), t.video.readyState >= t.video.HAVE_ENOUGH_DATA && a(e, "playing")))))
        }

        function p(e) {
            var t = this, i = t[h];
            i.driver.pause(), i.updater.stop(), t.webkitDisplayingFullscreen && t[b](), i.paused && !e || (i.paused = !0, i.hasAudio || a(t, "pause"), t.ended && (t[g] = !0, a(t, "ended")))
        }

        function c(e, i) {
            var r = e[h] = {};
            r.paused = !0, r.hasAudio = i, r.video = e, r.updater = t(l.bind(r)), i ? r.driver = s(e) : (e.addEventListener("canplay", function () {
                e.paused || a(e, "playing")
            }), r.driver = {
                src: e.src || e.currentSrc || "data:", muted: !0, paused: !0, pause: function () {
                    r.driver.paused = !0
                }, play: function () {
                    r.driver.paused = !1, d(r) && o(e, 0)
                }, get ended() {
                    return d(r)
                }
            }), e.addEventListener("emptied", function () {
                var t = !r.driver.src || "data:" === r.driver.src;
                r.driver.src && r.driver.src !== e.src && (o(e, 0, !0), r.driver.src = e.src, t ? r.driver.play() : r.updater.stop())
            }, !1), e.addEventListener("webkitbeginfullscreen", function () {
                e.paused ? i && 0 === r.driver.buffered.length && r.driver.load() : (e.pause(), e[y]())
            }), i && (e.addEventListener("webkitendfullscreen", function () {
                r.driver.currentTime = e.currentTime
            }), e.addEventListener("seeking", function () {
                _.indexOf(100 * e.currentTime | 0) < 0 && (r.driver.currentTime = e.currentTime)
            }))
        }

        function v(e) {
            var t = e[h];
            e[y] = e.play, e[b] = e.pause, e.play = u, e.pause = p, r(e, "paused", t.driver), r(e, "muted", t.driver, !0), r(e, "playbackRate", t.driver, !0), r(e, "ended", t.driver), r(e, "loop", t.driver, !0), i(e, "seeking"), i(e, "seeked"), i(e, "timeupdate", g, !1), i(e, "ended", g, !1)
        }

        var f,
            m = "object" == typeof document && "object-fit" in document.head.style && !matchMedia("(-webkit-video-playable-inline)").matches,
            h = "bfred-it:iphone-inline-video", g = "bfred-it:iphone-inline-video:event",
            y = "bfred-it:iphone-inline-video:nativeplay", b = "bfred-it:iphone-inline-video:nativepause", _ = [], w = 0;
        return function (e, t) {
            if (void 0 === t && (t = {}), !e[h]) {
                if (!t.everywhere) {
                    if (!m) return;
                    if (!(t.iPad || t.ipad ? /iPhone|iPod|iPad/ : /iPhone|iPod/).test(navigator.userAgent)) return
                }
                !e.paused && e.webkitDisplayingFullscreen && e.pause(), c(e, !e.muted), v(e), e.classList.add("IIV"), e.muted && e.autoplay && e.play(), /iPhone|iPod|iPad/.test(navigator.platform) || console.warn("iphone-inline-video is not guaranteed to work in emulated environments")
            }
        }
    }(), timeouts = [], did_show_results = !1, videoStopped = !0, video = document.querySelector(".video"),
    poster = $(".poster"), numSteps = $("[data-step]").length, activeStep = $(".step.is--active"),
    timer = $(".timer__container"), queryErrors = !1, lastValue = "", showUpgrade = !1, isMobile = !0;
$(document).ready(function () {
    videoLogic(), checkOrientation(isMobile), $(window).on("resize orientationchange", function () {
        checkOrientation(isMobile)
    })
});